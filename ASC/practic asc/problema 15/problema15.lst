     1                                  bits 32
     2                                  global start 
     3                                  import fclose msvcrt.dll
     4                                  import fscanf msvcrt.dll
     5                                  import fopen msvcrt.dll
     6                                  import scanf msvcrt.dll
     7                                  import printf msvcrt.dll
     8                                  import fprintf msvcrt.dll
     9                                  import gets msvcrt.dll
    10                                  import exit msvcrt.dll
    11                                  import fread msvcrt.dll
    12                                  extern printf, exit, scanf, fopen, fscanf, fclose, fprintf, gets,fread
    13                                  
    14                                  ;15.	Sa citesti un nume de fisier de la tastatura, sa deschizi fisieru, sa numeri cate caractere is in fisier, si apoi sa pui nr ala la capatu fisierului.
    15                                  
    16                                  segment data use32 class=data
    17 00000000 <res 000000C8>          s resb 200
    18                                  len equ 200
    19 000000C8 20257500                format_nr db ' %u',0
    20 000000CC <res 00000014>          filename resb 20
    21 000000E0 612B00                  mod_acces db 'a+',0
    22 000000E3 FFFFFFFF                descriptor dd -1
    23 000000E7 257300                  format_sir db '%s',0
    24 000000EA 4E7520732D61207075-     mesaj db 'Nu s-a putut deschide fisierul',0
    24 000000F3 747574206465736368-
    24 000000FC 696465206669736965-
    24 00000105 72756C00           
    25                                  segment code use32 class=code
    26                                  start:
    27                                      ;scanf(%s,filename)
    28 00000000 68[CC000000]                push filename
    29 00000005 68[E7000000]                push format_sir
    30 0000000A FF15[00000000]              call [scanf]
    31 00000010 83C408                      add esp,4*2
    32                                      
    33                                      ;fopen(filename,mod_acces)
    34 00000013 68[E0000000]                push mod_acces
    35 00000018 68[CC000000]                push filename
    36 0000001D FF15[00000000]              call [fopen]
    37 00000023 83C408                      add esp,4*2
    38                                      
    39 00000026 83F800                      cmp eax,0
    40 00000029 744C                        je eroare_deschidere
    41 0000002B A3[E3000000]                mov dword[descriptor],eax
    42                                      
    43                                      ;fread(s,len,descriptor)
    44 00000030 FF35[E3000000]              push dword[descriptor]
    45 00000036 68C8000000                  push  dword len
    46 0000003B 6A01                        push dword 1
    47 0000003D 68[00000000]                push s 
    48 00000042 FF15[00000000]              call [fread]
    49 00000048 83C410                      add esp,4*4
    50 0000004B 50                          push eax
    51 0000004C 68[C8000000]                push format_nr
    52 00000051 FF35[E3000000]              push dword[descriptor]
    53 00000057 FF15[00000000]              call [fprintf]
    54 0000005D 83C40C                      add esp,4*3
    55                                      
    56                                      ;fclose(descriptor)
    57 00000060 FF35[E3000000]              push dword[descriptor]
    58 00000066 FF15[00000000]              call [fclose]
    59 0000006C 83C404                      add esp,4
    60                                      
    61 0000006F 6A00                        push dword 0
    62 00000071 FF15[00000000]              call [exit]
    63                                      
    64                                      eroare_deschidere:
    65 00000077 68[EA000000]                push mesaj
    66 0000007C FF15[00000000]              call [printf]
    67 00000082 83C404                      add esp,4
    68                                      
    69 00000085 6A00                        push dword 0
    70 00000087 FF15[00000000]              call [exit]
    71                                  
    72                                     
