     1                                  bits 32
     2                                  global start 
     3                                  import fclose msvcrt.dll
     4                                  import fscanf msvcrt.dll
     5                                  import fopen msvcrt.dll
     6                                  import scanf msvcrt.dll
     7                                  import printf msvcrt.dll
     8                                  import fprintf msvcrt.dll
     9                                  import gets msvcrt.dll
    10                                  import exit msvcrt.dll
    11                                  extern printf, exit, scanf, fopen, fscanf, fclose, fprintf, gets
    12                                  
    13                                  
    14                                  
    15                                  ;Se citesc 3 numere din fisier. sa se afiseze inmultirea lor pe ecran.
    16                                  segment data use32 class=data
    17 00000000 00000000                a dd 0
    18 00000004 00000000                b dd 0
    19 00000008 00000000                c dd 0
    20 0000000C 256400                  format db '%d',0
    21 0000000F 696E2E74787400          filename db 'in.txt',0
    22 00000016 7200                    mod_acces db 'r',0
    23 00000018 FFFFFFFF                descriptor dd -1
    24 0000001C 256C6C6400              format_quad db '%lld',0
    25 00000021 466973696572756C20-     mesaj_eroare db 'Fisierul nu a putut fi deschis',0
    25 0000002A 6E7520612070757475-
    25 00000033 742066692064657363-
    25 0000003C 68697300           
    26 00000040 52657A756C74617475-     mesaj db 'Rezultatul este '
    26 00000049 6C206573746520     
    27                                  segment code use32 class=code
    28                                  start:
    29                                      ;fopen(filename,mod_acces)
    30 00000000 68[16000000]                push dword mod_acces
    31 00000005 68[0F000000]                push dword filename
    32 0000000A FF15[00000000]              call [fopen]
    33 00000010 83C408                      add esp,4*2
    34                                      
    35 00000013 83F800                      cmp EAX,0
    36 00000016 0F8493000000                je eroare_fisier
    37 0000001C A3[18000000]                mov [descriptor],eax
    38                                      
    39                                      ;fscanf(descriptor,format,&a)
    40 00000021 68[00000000]                push a
    41 00000026 68[0C000000]                push format
    42 0000002B FF35[18000000]              push dword[descriptor]
    43 00000031 FF15[00000000]              call [fscanf]
    44 00000037 83C40C                      add esp,4*3
    45                                      
    46 0000003A 68[04000000]                push b
    47 0000003F 68[0C000000]                push format
    48 00000044 FF35[18000000]              push dword[descriptor]
    49 0000004A FF15[00000000]              call [fscanf]
    50 00000050 83C40C                      add esp,4*3
    51                                      
    52 00000053 68[08000000]                push c
    53 00000058 68[0C000000]                push format
    54 0000005D FF35[18000000]              push dword[descriptor]
    55 00000063 FF15[00000000]              call [fscanf]
    56 00000069 83C40C                      add esp,4*3
    57                                      
    58 0000006C FF35[08000000]              push dword [c]
    59 00000072 FF35[04000000]              push dword [b]
    60 00000078 FF35[00000000]              push dword [a]
    61 0000007E E842000000                  call inmultire
    62                                      
    63 00000083 52                          push edx
    64 00000084 50                          push eax
    65 00000085 68[40000000]                push mesaj
    66 0000008A FF15[00000000]              call [printf]
    67 00000090 83C404                      add esp,4
    68                                      
    69 00000093 58                          pop eax
    70 00000094 5A                          pop edx
    71 00000095 FF30                        push dword[eax]
    72 00000097 FF32                        push dword[edx]
    73 00000099 68[1C000000]                push format_quad
    74 0000009E FF15[00000000]              call [printf]
    75 000000A4 83C40C                      add esp,4*3
    76                                      
    77 000000A7 6A00                        push dword 0
    78 000000A9 FF15[00000000]              call [exit]
    79                                      
    80                                      eroare_fisier:
    81 000000AF 68[21000000]                    push dword mesaj_eroare
    82 000000B4 FF15[00000000]                  call [printf]
    83 000000BA 83C404                          add esp,4
    84 000000BD 6A00                        push dword 0
    85 000000BF FF15[00000000]              call [exit]
    86                                  
    87                                     inmultire:
    88 000000C5 8B442404                    mov eax,[esp+4]
    89 000000C9 8B5C2408                    mov ebx,[esp+8]
    90 000000CD F7EB                        imul ebx
    91 000000CF 8B5C240C                    mov ebx,[esp+12]
    92 000000D3 F7EB                        imul ebx
    93 000000D5 C20C00                      ret 4*3
